#summary This is the working copy of the INSTALL file of the source package.
#labels Phase-Deploy

= Requirements =

You'll need a decent compiler, we have tested gcc on FreeBSD and
Sun Studio 8 on Solaris Sparc.

In order to configure dnsbl queries you need [http://daniel.haxx.se/projects/c-ares/ c-ares] library for
asynhronous dns queries. 

= Compiling =

You should be able to compile it for testing by just commanding:

{{{
$ ./configure --with-worker=sjsms --prefix=/tmp/gross
$ make install
}}}

Default worker protocol is Postfix's, if you use sjsms you must
specify it excplicitly.

= Basic configuration =

Default configuration is not yet included in the source package, so you
need to write `$PREFIX/etc/grossd.conf` yourself. Here is an example:

{{{
#update=gray
dnsbl=bl.spamcop.net
dnsbl=relays.ordb.org
dnsbl=sbl.spamhaus.org
dnsbl=dnsbl.njabl.org
dnsbl=cbl.abuseat.org
dnsbl=xbl.smaphaus.org
host=127.0.0.1
port=1111
filter_bits=21
number_buffers=8
rotate_interval=120 # 2 minutes
#synchost=
#syncport=
#peerhost=
#statefile=/tmp/grossd.state
}}}

This is a single server configuration. dnsbl entries are just what you'd
think they are. `update=gray` will update the datebase only in case of a
GRAY response. It is the default. `update=always` will enable enable
updating in any case. host and port are the ip and port for the server
to bind(). `filter_bits` is the length of the Bloom filter (actually the
bit vector length will be 2^filter_bits).

The server keeps the state information in the Bloom filter bit arrays.
By the nature of the filters you can insert elements in the filters, but
not to remove them. So we actually use several filters, and rotate them
on intervals. The actual filter is just a logical OR of those rotating
filters. `number_buffers` is the number of the rotating filters, and
rotate_interval is the interval in seconds. So, 8 buffers with 2 minutes
rotate interval will give you approximately 2 * 7.5 minutes worth of
state information. That is, any graylisted triplet will be stored for
some 15 minutes. Of course, you have to modify the numbers when going
into production. Default interval is 3600 seconds. This is the
configuration we use on our production servers:

{{{
dnsbl=rbl-plus.mail-abuse.org
dnsbl=bl.spamcop.net
dnsbl=relays.ordb.org
dnsbl=sbl.spamhaus.org
dnsbl=dnsbl.njabl.org
dnsbl=cbl.abuseat.org
dnsbl=xbl.smaphaus.org
dnsbl=dnsbl.sorbs.net
host=localhost
synchost=10.10.13.1
peerhost=10.10.13.2
number_buffers=12
filter_bits=24
statefile=grossd.state
}}}

`synchost` is the server ip, and `peerhost` stands for the replication
partners ip address.